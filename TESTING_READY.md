# âœ… HandsOff æµ‹è¯•ç¯å¢ƒå‡†å¤‡å®Œæˆ

æ­å–œï¼æ‰€æœ‰æµ‹è¯•å·¥å…·å’Œæ–‡æ¡£å·²å‡†å¤‡å°±ç»ªã€‚ç°åœ¨ä½ å¯ä»¥å¼€å§‹æµ‹è¯• HandsOff ç³»ç»Ÿäº†ã€‚

---

## ğŸ“ å·²åˆ›å»ºçš„æ–‡ä»¶

### 1. æµ‹è¯•é…ç½®

```
.env.example                    # ç¯å¢ƒå˜é‡æ¨¡æ¿ (å·²å­˜åœ¨)
scripts/test_data.sql           # æµ‹è¯•æ•°æ® SQL è„šæœ¬
```

### 2. æµ‹è¯•å·¥å…·

```
tools/test_components/main.go   # ç»„ä»¶å•å…ƒæµ‹è¯•è„šæœ¬
tools/encrypt_apikey/main.go    # API Key åŠ å¯†/è§£å¯†å·¥å…·
scripts/quick_test.sh           # å¿«é€Ÿæµ‹è¯•è„šæœ¬
```

### 3. æµ‹è¯•æ–‡æ¡£

```
TESTING_GUIDE.md                # å®Œæ•´æµ‹è¯•æŒ‡å— (è¯¦ç»†æ­¥éª¤)
TESTING_READY.md                # æœ¬æ–‡ä»¶ (å¿«é€Ÿå¼€å§‹)
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: ä½¿ç”¨å¿«é€Ÿæµ‹è¯•è„šæœ¬ (æ¨è)

```bash
# èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x scripts/quick_test.sh

# è¿è¡Œå¿«é€Ÿæµ‹è¯•
./scripts/quick_test.sh
```

**é¢„æœŸè¾“å‡º**:
```
==============================================
HandsOff å¿«é€Ÿæµ‹è¯•
==============================================

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1ï¸âƒ£  æ£€æŸ¥ç³»ç»Ÿä¾èµ–
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Testing Go installation... âœ“ PASS
Testing Redis CLI... âœ“ PASS
Testing SQLite3... âœ“ PASS

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2ï¸âƒ£  æ£€æŸ¥é…ç½®æ–‡ä»¶
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Testing .env file exists... âœ“ PASS
Testing ENCRYPTION_KEY set... âœ“ PASS
Testing DB_DSN set... âœ“ PASS
Testing REDIS_URL set... âœ“ PASS

...

âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç³»ç»Ÿå°±ç»ªã€‚
```

### æ–¹å¼ 2: æ‰‹åŠ¨è¿è¡Œå•å…ƒæµ‹è¯•

```bash
# 1. è¿è¡Œç»„ä»¶æµ‹è¯•
go run tools/test_components/main.go

# 2. æµ‹è¯• API Key åŠ å¯†
go run tools/encrypt_apikey/main.go -key "sk-your-api-key"

# 3. ç¼–è¯‘é¡¹ç›®
go build -o bin/api ./cmd/api
go build -o bin/worker ./cmd/worker
```

---

## ğŸ“‹ æµ‹è¯•å‰æ£€æŸ¥æ¸…å•

åœ¨å¼€å§‹æµ‹è¯•å‰ï¼Œè¯·ç¡®ä¿å®Œæˆä»¥ä¸‹å‡†å¤‡å·¥ä½œï¼š

### âœ… ç¯å¢ƒå‡†å¤‡

- [ ] å·²å®‰è£… Go 1.22+
- [ ] å·²å®‰è£… Redis å¹¶å¯åŠ¨
- [ ] å·²å®‰è£… SQLite3 æˆ– MySQL

### âœ… é…ç½®å‡†å¤‡

- [ ] å·²å¤åˆ¶ `.env.example` ä¸º `.env`
- [ ] å·²ç”Ÿæˆå¹¶é…ç½® `ENCRYPTION_KEY`
- [ ] å·²é…ç½® `DB_DSN` (æ•°æ®åº“è·¯å¾„)
- [ ] å·²é…ç½® `REDIS_URL`

### âœ… å¤–éƒ¨æœåŠ¡å‡†å¤‡

- [ ] å·²è·å– GitLab Access Token
- [ ] å·²è·å– LLM API Key (DeepSeek æˆ– OpenAI)
- [ ] å·²çŸ¥é“æµ‹è¯•é¡¹ç›®çš„ Project ID

### âœ… æ•°æ®å‡†å¤‡

- [ ] å·²è¿è¡Œä¸€æ¬¡ API Server (è‡ªåŠ¨åˆå§‹åŒ–æ•°æ®åº“)
- [ ] å·²åŠ å¯† LLM API Key
- [ ] å·²ç¼–è¾‘å¹¶æ‰§è¡Œ `scripts/test_data.sql`

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### é˜¶æ®µ 1: å•å…ƒæµ‹è¯• (30åˆ†é’Ÿ)

**ç›®çš„**: éªŒè¯å„ä¸ªç»„ä»¶ç‹¬ç«‹è¿è¡Œæ­£å¸¸

**æ­¥éª¤**:
1. è¿è¡Œå¿«é€Ÿæµ‹è¯•è„šæœ¬
2. è¿è¡Œç»„ä»¶æµ‹è¯•è„šæœ¬
3. æ£€æŸ¥æ‰€æœ‰æµ‹è¯•é€šè¿‡

**æ–‡æ¡£**: å‚è€ƒ `TESTING_GUIDE.md` â†’ å•å…ƒæµ‹è¯•

---

### é˜¶æ®µ 2: é›†æˆæµ‹è¯• (1-2å°æ—¶)

**ç›®çš„**: éªŒè¯å®Œæ•´çš„ Webhook â†’ LLM â†’ GitLab æµç¨‹

**æ­¥éª¤**:
1. é…ç½® GitLab Webhook
2. å¯åŠ¨ API Server å’Œ Worker
3. åˆ›å»ºæµ‹è¯• MR
4. è§‚å¯Ÿå¤„ç†æ—¥å¿—
5. éªŒè¯ GitLab MR è¯„è®º

**æ–‡æ¡£**: å‚è€ƒ `TESTING_GUIDE.md` â†’ é›†æˆæµ‹è¯•

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### ç¯å¢ƒç®¡ç†

```bash
# å¯åŠ¨ Redis
brew services start redis           # macOS
sudo systemctl start redis          # Linux
docker run -d -p 6379:6379 redis    # Docker

# ç”ŸæˆåŠ å¯†å¯†é’¥
openssl rand -base64 32

# åˆå§‹åŒ–æ•°æ®åº“
./bin/api  # è¿è¡Œä¸€æ¬¡å Ctrl+C
```

### å¼€å‘æµ‹è¯•

```bash
# ç¼–è¯‘é¡¹ç›®
go build -o bin/api ./cmd/api
go build -o bin/worker ./cmd/worker

# è¿è¡ŒæœåŠ¡
./bin/api       # Terminal 1 (API Server)
./bin/worker    # Terminal 2 (Worker)

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/app.log  # å¦‚æœé…ç½®äº†æ—¥å¿—æ–‡ä»¶
```

### æ•°æ®åº“æ“ä½œ

```bash
# è¿æ¥æ•°æ®åº“
sqlite3 data/handsoff.db

# æŸ¥çœ‹è¡¨ç»“æ„
.schema llm_providers

# æŸ¥çœ‹æ•°æ®
SELECT * FROM repositories;

# æ‰§è¡Œ SQL è„šæœ¬
sqlite3 data/handsoff.db < scripts/test_data.sql
```

### API Key åŠ å¯†

```bash
# åŠ å¯† API Key
go run tools/encrypt_apikey/main.go -key "sk-your-api-key"

# è§£å¯†éªŒè¯
go run tools/encrypt_apikey/main.go -decrypt "encrypted-value"
```

---

## ğŸ“– è¯¦ç»†æ–‡æ¡£

### ä¸»è¦æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|------|----------|
| `TESTING_GUIDE.md` | å®Œæ•´æµ‹è¯•æŒ‡å— | **å¿…è¯»** - è¯¦ç»†æ­¥éª¤å’Œé—®é¢˜æ’æŸ¥ |
| `TESTING_READY.md` | æœ¬æ–‡æ¡£ | å¿«é€Ÿå¼€å§‹å’Œå‘½ä»¤å‚è€ƒ |
| `WEEK4_PROGRESS_SUMMARY.md` | Week 4 è¿›åº¦æ€»ç»“ | äº†è§£å·²å®Œæˆçš„åŠŸèƒ½ |
| `.env.example` | ç¯å¢ƒå˜é‡æ¨¡æ¿ | é…ç½®å‚è€ƒ |

### å·¥å…·è„šæœ¬

| è„šæœ¬ | ç”¨é€” | è¿è¡Œæ–¹å¼ |
|------|------|----------|
| `scripts/quick_test.sh` | å¿«é€Ÿæµ‹è¯• | `./scripts/quick_test.sh` |
| `tools/test_components/main.go` | å•å…ƒæµ‹è¯• | `go run tools/test_components/main.go` |
| `tools/encrypt_apikey/main.go` | åŠ å¯†å·¥å…· | `go run tools/encrypt_apikey/main.go -key "..."` |
| `scripts/test_data.sql` | æµ‹è¯•æ•°æ® | `sqlite3 data/handsoff.db < scripts/test_data.sql` |

---

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### å•å…ƒæµ‹è¯•ç›®æ ‡

- [x] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [x] Redis é˜Ÿåˆ—å·¥ä½œ
- [x] GitLab API å¯è®¿é—®
- [x] LLM API å¯è°ƒç”¨

### é›†æˆæµ‹è¯•ç›®æ ‡

- [ ] Webhook æ¥æ”¶ MR äº‹ä»¶
- [ ] ä»»åŠ¡æˆåŠŸå…¥é˜Ÿåˆ° Redis
- [ ] Worker æ¥æ”¶å¹¶å¤„ç†ä»»åŠ¡
- [ ] æˆåŠŸè·å– GitLab MR Diff
- [ ] LLM è¿”å›å®¡æŸ¥ç»“æœ
- [ ] ç»“æœä¿å­˜åˆ°æ•°æ®åº“
- [ ] è¯„è®ºå‘å¸ƒåˆ° GitLab MR
- [ ] è¯„è®ºæ ¼å¼æ­£ç¡®ç¾è§‚

---

## âš¡ å¿«é€Ÿæµ‹è¯•æµç¨‹ (3åˆ†é’Ÿç‰ˆ)

å¦‚æœä½ å·²ç»å®Œæˆæ‰€æœ‰é…ç½®ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæœ€å¿«çš„æµ‹è¯•æµç¨‹ï¼š

```bash
# 1. å¿«é€Ÿæ£€æŸ¥ (30ç§’)
./scripts/quick_test.sh

# 2. å¯åŠ¨æœåŠ¡ (10ç§’)
./bin/api &        # åå°è¿è¡Œ API
./bin/worker &     # åå°è¿è¡Œ Worker

# 3. æµ‹è¯• Webhook (1åˆ†é’Ÿ)
# åœ¨ GitLab ä¸­ç‚¹å‡» Test â†’ Merge request events

# 4. åˆ›å»ºæµ‹è¯• MR (1åˆ†é’Ÿ)
# åœ¨ GitLab ä¸­åˆ›å»ºä¸€ä¸ªç®€å•çš„ MR

# 5. æ£€æŸ¥ç»“æœ (30ç§’)
# æŸ¥çœ‹ GitLab MR é¡µé¢ï¼Œåº”è¯¥æœ‰ AI è¯„è®º

# 6. åœæ­¢æœåŠ¡
pkill api worker
```

---

## â“ é‡åˆ°é—®é¢˜ï¼Ÿ

### ç¬¬ä¸€æ­¥ï¼šè¿è¡Œå¿«é€Ÿæµ‹è¯•

```bash
./scripts/quick_test.sh
```

æ ¹æ®è¾“å‡ºçš„é”™è¯¯ä¿¡æ¯è¿›è¡Œä¿®å¤ã€‚

### ç¬¬äºŒæ­¥ï¼šæŸ¥çœ‹è¯¦ç»†æ–‡æ¡£

æ‰€æœ‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆéƒ½åœ¨ **`TESTING_GUIDE.md`** ä¸­ï¼ŒåŒ…æ‹¬ï¼š

- æ•°æ®åº“è¿æ¥å¤±è´¥
- Redis è¿æ¥å¤±è´¥
- GitLab API è®¤è¯å¤±è´¥
- LLM API è°ƒç”¨å¤±è´¥
- Webhook æœªè§¦å‘
- Worker å¤„ç†å¤±è´¥
- è¯„è®ºæœªå‘å¸ƒ

### ç¬¬ä¸‰æ­¥ï¼šæŸ¥çœ‹æ—¥å¿—

```bash
# API Server æ—¥å¿—
# (ç›´æ¥åœ¨ Terminal ä¸­æŸ¥çœ‹)

# Worker æ—¥å¿—
# (ç›´æ¥åœ¨ Terminal ä¸­æŸ¥çœ‹)

# Redis é˜Ÿåˆ—çŠ¶æ€
redis-cli
> LLEN asynq:queues:code_review
```

---

## ğŸ‰ æµ‹è¯•æˆåŠŸå

æ­å–œï¼å¦‚æœæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œä½ å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´å¯ç”¨çš„ AI ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼

### ä¸‹ä¸€æ­¥é€‰æ‹©

**é€‰é¡¹ 1: ä¼˜åŒ–ç°æœ‰åŠŸèƒ½**
- Task 5: Review ç»“æœå­˜å‚¨ä¼˜åŒ–
- æ‰¹é‡æ’å…¥ã€äº‹åŠ¡å¤„ç†

**é€‰é¡¹ 2: å¼€å‘å‰ç«¯ç•Œé¢**
- Task 6: Review åˆ—è¡¨é¡µé¢
- Task 7: Review è¯¦æƒ…é¡µé¢

**é€‰é¡¹ 3: ç”Ÿäº§éƒ¨ç½²**
- Docker é•œåƒæ„å»º
- Kubernetes éƒ¨ç½²
- ç›‘æ§å‘Šè­¦é…ç½®

**é€‰é¡¹ 4: æ‰©å±•åŠŸèƒ½**
- æ”¯æŒæ›´å¤š LLM Provider (Claude, Gemini)
- æ”¯æŒ GitHub
- è‡ªåŠ¨ä¿®å¤å»ºè®®

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜ï¼š

1. âœ… ä»”ç»†é˜…è¯» `TESTING_GUIDE.md` ä¸­çš„"å¸¸è§é—®é¢˜æ’æŸ¥"
2. âœ… æ£€æŸ¥æ—¥å¿—ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯
3. âœ… éªŒè¯é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
4. âœ… ç¡®è®¤å¤–éƒ¨æœåŠ¡ (GitLab, LLM) å¯è®¿é—®

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸš€**

å¼€å§‹æµ‹è¯•å§ï¼š`./scripts/quick_test.sh`
